--[[
 Death Ball Auto Parry + Interface (Movível, Minimizável, Toggle)
 Para uso em executor mobile (Delta, Arceus, etc) e PC
 Tested & optimized for dev use (nathandacruz244)
]]

-- Serviços
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local VirtualInputManager = game:GetService("VirtualInputManager")

-- Interface
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "DeathBallAutoParryGui"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = (game.CoreGui or LocalPlayer.PlayerGui)

local Main = Instance.new("Frame")
Main.Size = UDim2.new(0, 220, 0, 110)
Main.Position = UDim2.new(0.75, 0, 0.4, 0)
Main.BackgroundColor3 = Color3.fromRGB(31, 31, 31)
Main.BorderSizePixel = 0
Main.Active = true
Main.Draggable = true
Main.Parent = ScreenGui

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 30)
Title.BackgroundTransparency = 1
Title.Text = "Death Ball Auto Parry"
Title.Font = Enum.Font.GothamBold
Title.TextSize = 16
Title.TextColor3 = Color3.fromRGB(255,255,255)
Title.Parent = Main

local Status = Instance.new("TextLabel")
Status.Size = UDim2.new(1, 0, 0, 18)
Status.Position = UDim2.new(0,0,0,32)
Status.BackgroundTransparency = 1
Status.Text = "Status: Desativado"
Status.Font = Enum.Font.Gotham
Status.TextSize = 13
Status.TextColor3 = Color3.fromRGB(255, 80, 80)
Status.Parent = Main

local Toggle = Instance.new("TextButton")
Toggle.Size = UDim2.new(0, 90, 0, 28)
Toggle.Position = UDim2.new(0.5, -45, 0, 56)
Toggle.BackgroundColor3 = Color3.fromRGB(69, 69, 69)
Toggle.Text = "Ativar"
Toggle.Font = Enum.Font.GothamBold
Toggle.TextSize = 15
Toggle.TextColor3 = Color3.fromRGB(255,255,255)
Toggle.Parent = Main

local MinBtn = Instance.new("TextButton")
MinBtn.Size = UDim2.new(0, 30, 0, 25)
MinBtn.Position = UDim2.new(1, -34, 0, 6)
MinBtn.BackgroundColor3 = Color3.fromRGB(45,45,45)
MinBtn.Text = "-"
MinBtn.Font = Enum.Font.GothamBold
MinBtn.TextSize = 18
MinBtn.TextColor3 = Color3.fromRGB(200,200,200)
MinBtn.Parent = Main

-- Minimizar
local minimized = false
MinBtn.MouseButton1Click:Connect(function()
    minimized = not minimized
    for _,v in ipairs(Main:GetChildren()) do
        if v ~= MinBtn and v ~= Title then
            v.Visible = not minimized
        end
    end
    Main.Size = minimized and UDim2.new(0,220,0,35) or UDim2.new(0,220,0,110)
    MinBtn.Text = minimized and "+" or "-"
end)

-- Toggle Auto Parry
local autoParryActive = false
Toggle.MouseButton1Click:Connect(function()
    autoParryActive = not autoParryActive
    Toggle.Text = autoParryActive and "Desativar" or "Ativar"
    Status.Text = "Status: " .. (autoParryActive and "Ativado" or "Desativado")
    Status.TextColor3 = autoParryActive and Color3.fromRGB(80,255,80) or Color3.fromRGB(255,80,80)
end)

-- Movimentação mobile/PC (exemplo adaptado de scripts públicos)
local dragging, dragInput, dragStart, startPos
Main.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = Main.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)
Main.InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        local delta = input.Position - dragStart
        Main.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- Função para detectar bola do Death Ball (nome padrão: "Ball", "DeathBall", ou variantes)
local function isDeathBall(obj)
    if obj:IsA("Part") and (obj.Name:lower():find("ball")) then
        return true
    end
    return false
end

-- Função principal de auto parry
local function doAutoParry()
    if not autoParryActive then return end
    local char = LocalPlayer.Character
    if not char or not char:FindFirstChild("HumanoidRootPart") then return end
    local hrp = char.HumanoidRootPart

    for _,ball in ipairs(Workspace:GetChildren()) do
        if isDeathBall(ball) then
            local dist = (hrp.Position - ball.Position).Magnitude
            local vel = ball.Velocity
            -- Bola vindo para o jogador e dentro do range
            if dist <= 16 and vel.Magnitude > 10 then
                local directionToPlayer = (hrp.Position - ball.Position).Unit
                if directionToPlayer:Dot(vel.Unit) > 0.7 then
                    -- Parry: RemoteEvent ou tecla "F"
                    local tool = char:FindFirstChildOfClass("Tool")
                    if tool and tool:FindFirstChild("Parry") then
                        tool.Parry:FireServer()
                    else
                        -- Simula pressionar "F" (Delta suporta VirtualInputManager)
                        VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.F, false, game)
                        wait(0.05)
                        VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.F, false, game)
                    end
                    Status.Text = "Status: Bola Rebatida!"
                    Status.TextColor3 = Color3.fromRGB(80, 180, 255)
                    wait(0.13)
                    Status.Text = "Status: Ativado"
                    Status.TextColor3 = Color3.fromRGB(80,255,80)
                end
            end
        end
    end
end

-- Loop
RunService.RenderStepped:Connect(function()
    pcall(doAutoParry)
end)

-- Fps cap para mobile (opcional)
if setfpscap then setfpscap(60) end

-- Créditos: Interface baseada em exemplos públicos do V3rmillion, Pastebin, YouTube (DeathBall GUI/Auto Parry)
-- Script feito para nathandacruz244, autorizado para testes internos no jogo Death Ball
